{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyadong/Documents/GitHub/00%E7%BE%A4%E7%9C%8B%E6%9D%BF/src/config/index.ts"],"sourcesContent":["// Load .env files for scripts (tsx/ts-node) - but NOT in Edge Runtime or browser\n// This ensures scripts can read DATABASE_URL and other env vars\n// Check for real Node.js environment by looking at global 'process' properties\nif (\n  typeof process !== 'undefined' &&\n  typeof process.cwd === 'function' &&\n  !process.env.NEXT_RUNTIME // Skip if in Next.js runtime (already loaded)\n) {\n  try {\n    const dotenv = require('dotenv');\n    dotenv.config({ path: '.env.development' });\n    dotenv.config({ path: '.env', override: false });\n  } catch (e) {\n    // Silently fail - dotenv might not be available in some environments\n  }\n}\n\nexport type ConfigMap = Record<string, string>;\n\nexport const envConfigs = {\n  app_url: process.env.NEXT_PUBLIC_APP_URL ?? 'http://localhost:3000',\n  app_name: process.env.NEXT_PUBLIC_APP_NAME ?? 'ShipAny App',\n  theme: process.env.NEXT_PUBLIC_THEME ?? 'default',\n  appearance: process.env.NEXT_PUBLIC_APPEARANCE ?? 'system',\n  locale: process.env.NEXT_PUBLIC_DEFAULT_LOCALE ?? 'en',\n  database_url: process.env.DATABASE_URL ?? '',\n  database_provider: process.env.DATABASE_PROVIDER ?? 'postgresql',\n  db_singleton_enabled: process.env.DB_SINGLETON_ENABLED || 'false',\n  auth_url: process.env.AUTH_URL || process.env.NEXT_PUBLIC_APP_URL || '',\n  auth_secret: process.env.AUTH_SECRET ?? '', // openssl rand -base64 32\n};\n"],"names":[],"mappings":"AAAA,iFAAiF;AACjF,gEAAgE;AAChE,+EAA+E;;;;;AAC/E;;AAgBO,MAAM,aAAa;IACxB,SAAS,6DAAmC;IAC5C,UAAU,mDAAoC;IAC9C,OAAO,+CAAiC;IACxC,YAAY,8CAAsC;IAClD,QAAQ,QAAQ,GAAG,CAAC,0BAA0B,IAAI;IAClD,cAAc,QAAQ,GAAG,CAAC,YAAY,IAAI;IAC1C,mBAAmB,QAAQ,GAAG,CAAC,iBAAiB,IAAI;IACpD,sBAAsB,QAAQ,GAAG,CAAC,oBAAoB,IAAI;IAC1D,UAAU,QAAQ,GAAG,CAAC,QAAQ,iEAAuC;IACrE,aAAa,QAAQ,GAAG,CAAC,WAAW,IAAI;AAC1C","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyadong/Documents/GitHub/00%E7%BE%A4%E7%9C%8B%E6%9D%BF/src/config/locale/index.ts"],"sourcesContent":["import { envConfigs } from '..';\n\nexport const localeNames: any = {\n  en: 'English',\n  zh: '中文',\n};\n\nexport const locales = ['en', 'zh'];\n\nexport const defaultLocale = envConfigs.locale;\n\nexport const localePrefix = 'as-needed';\n\nexport const localeDetection = false;\n\nexport const localeMessagesRootPath = '@/config/locale/messages';\n\nexport const localeMessagesPaths = [\n  'common',\n  'landing',\n  'showcases',\n  'blog',\n  'pricing',\n  'settings/sidebar',\n  'settings/profile',\n  'settings/security',\n  'settings/billing',\n  'settings/payments',\n  'settings/credits',\n  'settings/apikeys',\n  'admin/sidebar',\n  'admin/users',\n  'admin/roles',\n  'admin/permissions',\n  'admin/categories',\n  'admin/posts',\n  'admin/payments',\n  'admin/subscriptions',\n  'admin/credits',\n  'admin/settings',\n  'admin/apikeys',\n  'admin/ai-tasks',\n  'admin/chats',\n  'ai/music',\n  'ai/chat',\n  'ai/image',\n  'activity/sidebar',\n  'activity/ai-tasks',\n  'activity/chats',\n];\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;AAEO,MAAM,cAAmB;IAC9B,IAAI;IACJ,IAAI;AACN;AAEO,MAAM,UAAU;IAAC;IAAM;CAAK;AAE5B,MAAM,gBAAgB,oIAAU,CAAC,MAAM;AAEvC,MAAM,eAAe;AAErB,MAAM,kBAAkB;AAExB,MAAM,yBAAyB;AAE/B,MAAM,sBAAsB;IACjC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD","debugId":null}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyadong/Documents/GitHub/00%E7%BE%A4%E7%9C%8B%E6%9D%BF/src/core/i18n/config.ts"],"sourcesContent":["import { defineRouting } from 'next-intl/routing';\n\nimport {\n  defaultLocale,\n  localeDetection,\n  localePrefix,\n  locales,\n} from '@/config/locale';\n\nexport const routing = defineRouting({\n  locales,\n  defaultLocale,\n  localePrefix,\n  localeDetection,\n});\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;AAOO,MAAM,UAAU,IAAA,kcAAa,EAAC;IACnC,SAAA,2IAAO;IACP,eAAA,iJAAa;IACb,cAAA,gJAAY;IACZ,iBAAA,mJAAe;AACjB","debugId":null}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyadong/Documents/GitHub/00%E7%BE%A4%E7%9C%8B%E6%9D%BF/src/proxy.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { getSessionCookie } from 'better-auth/cookies';\nimport createIntlMiddleware from 'next-intl/middleware';\n\nimport { routing } from '@/core/i18n/config';\n\nconst intlMiddleware = createIntlMiddleware(routing);\n\nexport async function proxy(request: NextRequest) {\n  const { pathname } = request.nextUrl;\n\n  // Handle internationalization first\n  const intlResponse = intlMiddleware(request);\n\n  // Extract locale from pathname\n  const locale = pathname.split('/')[1];\n  const isValidLocale = routing.locales.includes(locale as any);\n  const pathWithoutLocale = isValidLocale\n    ? pathname.slice(locale.length + 1)\n    : pathname;\n\n  // Only check authentication for admin routes\n  if (\n    pathWithoutLocale.startsWith('/admin') ||\n    pathWithoutLocale.startsWith('/settings') ||\n    pathWithoutLocale.startsWith('/activity')\n  ) {\n    // Check if session cookie exists\n    const sessionCookie = getSessionCookie(request);\n\n    // If no session token found, redirect to sign-in\n    if (!sessionCookie) {\n      const signInUrl = new URL(\n        isValidLocale ? `/${locale}/sign-in` : '/sign-in',\n        request.url\n      );\n      // Add the current path (including search params) as callback - use relative path for multi-language support\n      const callbackPath = pathWithoutLocale + request.nextUrl.search;\n      signInUrl.searchParams.set('callbackUrl', callbackPath);\n      return NextResponse.redirect(signInUrl);\n    }\n\n    // For admin routes, we need to check RBAC permissions\n    // Note: Full permission check happens in the page/API route level\n    // This is a lightweight session check to prevent unauthorized access\n    // The detailed permission check (admin.access and specific permissions)\n    // will be done in the layout or individual pages using requirePermission()\n  }\n\n  intlResponse.headers.set('x-pathname', request.nextUrl.pathname);\n  intlResponse.headers.set('x-url', request.url);\n\n  // For all other routes (including /, /sign-in, /sign-up, /sign-out), just return the intl response\n  return intlResponse;\n}\n\nexport const config = {\n  matcher: '/((?!api|trpc|_next|_vercel|.*\\\\..*).*)',\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,gZAAoB,EAAC,wIAAO;AAE5C,eAAe,MAAM,OAAoB;IAC9C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,oCAAoC;IACpC,MAAM,eAAe,eAAe;IAEpC,+BAA+B;IAC/B,MAAM,SAAS,SAAS,KAAK,CAAC,IAAI,CAAC,EAAE;IACrC,MAAM,gBAAgB,wIAAO,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC/C,MAAM,oBAAoB,gBACtB,SAAS,KAAK,CAAC,OAAO,MAAM,GAAG,KAC/B;IAEJ,6CAA6C;IAC7C,IACE,kBAAkB,UAAU,CAAC,aAC7B,kBAAkB,UAAU,CAAC,gBAC7B,kBAAkB,UAAU,CAAC,cAC7B;QACA,iCAAiC;QACjC,MAAM,gBAAgB,IAAA,oXAAgB,EAAC;QAEvC,iDAAiD;QACjD,IAAI,CAAC,eAAe;YAClB,MAAM,YAAY,IAAI,IACpB,gBAAgB,CAAC,CAAC,EAAE,OAAO,QAAQ,CAAC,GAAG,YACvC,QAAQ,GAAG;YAEb,4GAA4G;YAC5G,MAAM,eAAe,oBAAoB,QAAQ,OAAO,CAAC,MAAM;YAC/D,UAAU,YAAY,CAAC,GAAG,CAAC,eAAe;YAC1C,OAAO,0VAAY,CAAC,QAAQ,CAAC;QAC/B;IAEA,sDAAsD;IACtD,kEAAkE;IAClE,qEAAqE;IACrE,wEAAwE;IACxE,2EAA2E;IAC7E;IAEA,aAAa,OAAO,CAAC,GAAG,CAAC,cAAc,QAAQ,OAAO,CAAC,QAAQ;IAC/D,aAAa,OAAO,CAAC,GAAG,CAAC,SAAS,QAAQ,GAAG;IAE7C,mGAAmG;IACnG,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;AACX","debugId":null}}]
}